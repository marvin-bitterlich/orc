#!/bin/bash

# =============================================================================
# Post-merge hook - Reminder for AI agents
# Shows breadcrumbs about post-merge tasks
# =============================================================================

BRANCH=$(git rev-parse --abbrev-ref HEAD)
echo ""
echo "ğŸ“ Merged into: $BRANCH"

# Remind about schema sync
if command -v atlas &>/dev/null; then
    if atlas schema diff --env local 2>/dev/null | grep -q .; then
        echo "âš ï¸  Schema may differ from schema.sql"
        echo "   Run: make schema-diff   (preview)"
        echo "   Run: make schema-apply  (apply changes)"
    else
        echo "âœ“ Schema appears in sync"
    fi
else
    echo "ğŸ’¡ Atlas not installed - run: brew install ariga/tap/atlas"
fi

# Master/main branch reminders
if [[ "$BRANCH" == "master" || "$BRANCH" == "main" ]]; then
    echo ""
    echo "ğŸ“‹ Master branch checklist:"
    echo "   [ ] make init          # Initialize dependencies"
    echo "   [ ] make install       # Install orc binary"
    echo "   [ ] make deploy-glue   # Deploy Claude Code glue"
    echo "   [ ] make test          # Verify tests pass"
fi
echo ""
